from collections import Counter

def count_timelines(grid):
    R = len(grid)
    C = len(grid[0])
    sr = 0
    sc = grid[0].index("S")
    active = Counter()
    active[(sr+1, sc)] = 1
    finished = 0

    while active:
        nxt = Counter()
        for (r, c), k in active.items():
            if r < 0 or c < 0 or c >= C or r >= R:
                finished += k
                continue
            cell = grid[r][c]
            if cell == "." or cell == "S":
                nxt[(r+1, c)] += k
            elif cell == "^":
                nxt[(r, c-1)] += k
                nxt[(r, c+1)] += k
            else:
                nxt[(r+1, c)] += k
        active = nxt
    return finished

raw = """

......................................................................S......................................................................
.............................................................................................................................................
......................................................................^......................................................................
.............................................................................................................................................
.....................................................................^.^.....................................................................
.............................................................................................................................................
....................................................................^.^.^....................................................................
.............................................................................................................................................
...................................................................^.^...^...................................................................
.............................................................................................................................................
..................................................................^.......^..................................................................
.............................................................................................................................................
.................................................................^.^.^.^...^.................................................................
.............................................................................................................................................
................................................................^.^.^.^.^.^.^................................................................
.............................................................................................................................................
...............................................................^.^.^.^.....^.^...............................................................
.............................................................................................................................................
..............................................................^.^.^.^.^...^.^.^..............................................................
.............................................................................................................................................
.............................................................^...^...^.^.^.^.^.^.............................................................
.............................................................................................................................................
............................................................^.^.^.^.^...^...^.^.^............................................................
.............................................................................................................................................
...........................................................^.^...^.^.^...^.^...^.^...........................................................
.............................................................................................................................................
..........................................................^.^.^...^.^.^...^.^.....^..........................................................
.............................................................................................................................................
.........................................................^.^.^.^.^.^...^...^.^.^...^.........................................................
.............................................................................................................................................
........................................................^.^.^.^.^...^.^...^.^...^.^.^........................................................
.............................................................................................................................................
.......................................................^.^.....^.^...^.^...^.^.^.^...^.......................................................
.............................................................................................................................................
......................................................^.^...^.^...^...^.^.^.^...^...^.^......................................................
.............................................................................................................................................
.....................................................^.^.^.^.^...^...^.^.^.^.^...^.^.^.^.....................................................
.............................................................................................................................................
....................................................^...^.^.^.........^.^...^...^...^.^.^....................................................
.............................................................................................................................................
...................................................^...^.^.^.^.......^...^.^...^.^.^...^.^...................................................
.............................................................................................................................................
..................................................^.^.^.....^.^.^.^.^.^.^.^.^...^.^.^...^.^..................................................
.............................................................................................................................................
.................................................^.....^...^.^.^.^.^.....^.^.^...^.....^...^.................................................
.............................................................................................................................................
................................................^.^.^.^.^.^...^.^.^.^...^.^.^.^.^.^.^.^.^.^.^................................................
.............................................................................................................................................
...............................................^.^.^.^.^.^...^.^...^.....^.....^.^...^.....^.^...............................................
.............................................................................................................................................
..............................................^.^.^...^...^.^.^.^.^.^...^.^.^.^.^.^...^...^.^.^..............................................
.............................................................................................................................................
.............................................^.^...^.^...^.^...^.....^...^.^.^.^.^.^...^.^.^.^.^.............................................
.............................................................................................................................................
............................................^.^...^.^...^.^.^.^.^...^.^.^...^.^...^...^...^.^.^.^............................................
.............................................................................................................................................
...........................................^.^.....^...^.^.^...^.^...^.^.^...^.^.............^...^...........................................
.............................................................................................................................................
..........................................^...^...^.^.^.^.....^.^.^.^.^.^.^...^...^.^...^...^.^.^.^..........................................
.............................................................................................................................................
.........................................^.^...^.^.^.^.^.....^.^.^.....^...^...^...^.^.^.^.....^.^.^.........................................
.............................................................................................................................................
........................................^.^...^.^.^.^.^.^.^.^.^.....^.....^.^.^...^.^.^.^.....^.^...^........................................
.............................................................................................................................................
.......................................^...^.^.^.^.^.^...^.^.^.^.^.^...^...^...^.^.........^.......^.^.......................................
.............................................................................................................................................
......................................^.^.^.^.^.^.^.^.^.^.^.^.^.......^.^.^.^.^.^.^.^.^.^...^.^.^...^.^......................................
.............................................................................................................................................
.....................................^...^.......^.^.....^...^.^.^.^.^...^.^.^.^.........^...^...^.^.^.^.....................................
.............................................................................................................................................
....................................^...^.^.^.^.^.^.^.....^.^...^...^.^.^.^.^.^...^.^.^.^.^.^.^.^...^.^.^....................................
.............................................................................................................................................
...................................^.^.^.^.^...^.^.^.^.^.^...^.^.^.....^.^...^.^...^.....^.....^.^...^.^.^...................................
.............................................................................................................................................
..................................^.^.^...^...^.^.^...^.^.^.^.^.^.^.^.^.^...^.^.^.^.^...^.^.....^.^.^.^.^.^..................................
.............................................................................................................................................
.................................^.^.^.^.^...^.^.^.^.^...^.........^.^.^...^...^.....^.....^...^...^.^...^.^.................................
.............................................................................................................................................
................................^.....^.^.^.^.^.^.^.^...^.^.^.^.^.^.^.^.^.^.^.^.^.^...^.....^.^.^.^.^.^.^.^.^................................
.............................................................................................................................................
...............................^.^.^.^...^.^.^...^.....^.^.^.^.^.^...^.^.^.....^.^.^.^.^.^.^.^.^.^.^.....^...^...............................
.............................................................................................................................................
..............................^...^.^...^.^.^.....^...^.^.^.^.^.^.^.^.^.^.^.^.^...^.^.^.^...^.^...^.^.^.^.^...^..............................
.............................................................................................................................................
.............................^.....^.^.^...^.^.^.^.^...^.^.^...^.^...^.^.^.^.^.^...^...^...^.^.^...^.^.^.^.^.^.^.............................
.............................................................................................................................................
............................^.^.^.^...^.^.^.^.^.^.^...^.^.....^.....^.^.^.^.^.^...^.^...^.^...^.^.....^.^.^.^.^.^............................
.............................................................................................................................................
...........................^.^...^.^.^...^.^.^.^.^.^.^.^.^.....^.^.^...^.....^...^...^.^...^.^.^.^.^.^...^...^...^...........................
.............................................................................................................................................
..........................^.^.^.^...^.....^...^.^.^.^...^.^.^.^.^.^...^.^.^.^.^...^.^.^.^.^.^.^.^.^.^...^.^.^.^.^.^..........................
.............................................................................................................................................
.........................^.^.^.^...^.^.^.....^.^.^...^.....^.^.^.^.^.^...^.^.....^.^.^.^.^.^.^.^.^.^.^.^.^.^.^.^.^.^.........................
.............................................................................................................................................
........................^.^.^.^...^.^.^.^.^...^...^.^...^.^.^...^...^.^.^.^.^...^.....^.^.^.^.^.^.^.^.^.^.....^.^.^.^........................
.............................................................................................................................................
.......................^.^.^...^.^.^.^.^.^.^.^.^.^.^.^.^.^...^.^...^.^...^...^.^.^...^.^.^.......^.^.^...^.....^.^.^.^.......................
.............................................................................................................................................
......................^.^.......^.^.^.^...^...........^.^.^.^.^.^.^.^...^.^.^.^.^.^.^...^...^.^.^.^.^.^.^.^.^.^.......^......................
.............................................................................................................................................
.....................^.^.........^.^...^.^.^.^.^.^.^.^.^...^.....^.^.^.........^.^.^.^.^...^.^.^...^...^...^.^.^.^.^.^.^.....................
.............................................................................................................................................
....................^.^...^...^.^.^.^.^.^.^...^.^.^.^.^.^.^...^.^.^.^.^...^...^.^...^...^.....^...^.^.^.^.^.^.......^.^.^....................
.............................................................................................................................................
...................^.^.^.^.^...^.^.^.^.^.^.^.^.^...^.^.....^.^.^.^.^.^.........^...^.^.^.^.^.^.^.^.^.^...^.^.^.....^.^.^.^...................
.............................................................................................................................................
..................^.^.^...^...^.^.^.^...^.^...^.^.^.^.^.^.^.^.^...^.^...^.^...^.^.^.^.^.^...^...^.^.^.^.^.^.^.^.^...^...^.^..................
.............................................................................................................................................
.................^.....^.....^.^.^.^.^...^...^.^...^...^.^.^.^.^.....^.^.^...^.....^.^.^.^.^...^.^.^.....^...^.^...^.^.^.^.^.................
.............................................................................................................................................
................^...^.^.^...^.^.^...^.^.^.^.^.^.^.^.^.^.^...^.....^.^.^...^.^...........^.^.^.^.^...^.^.^.^.^.^.^.^.^...^...^................
.............................................................................................................................................
...............^.^.....^.^...^.^.^.....^.^.^.^.^.^.^.^.^.........^.^.^.^.^.^...^...^...^...^.^.^...^.^.^.^.^.^.^.^.^...^.^.^.^...............
.............................................................................................................................................
..............^...^.....^.^.^.^...^.^...^.....^...^.^.^.^.^...^.^.^.^.^.^.^.^.....^...^.^.^.^...^.^.^.^.^.^...^...^.^.^...^.^.^..............
.............................................................................................................................................
.............^.^...^.^.^.^.^.^.^.^...^...^.^.^.^...^.^.^...^.^...^...^.^.^.......^.^...^.^...^.^.^.^.^.^.^.^.^.^.^.....^...^.^.^.............
.............................................................................................................................................
............^...^.^...^.^.^...^...^...^.^.^.^.^.^.....^.^.^.^.^...^.^.....^.......^...^.^.^.^.^...^.^.....^.^...^.^.^.^.^.^.^.^.^............
.............................................................................................................................................
...........^.^.^...^.^.^.^...^.^...^.^.....^.^.^.^.^.^.^.....^...^.^.......^.^...^...^.^.^.^...^.^.^.^...^.^.^...^.^...^.^...^...^...........
.............................................................................................................................................
..........^.^.^.^.^...^.....^...^.^.^...^.^...^.^.^...^.^...^.^...^.^.^.^.....^.......^.^.^.^.^...^.^.^.^.^...^.^...........^.^.^.^..........
.............................................................................................................................................
.........^.^...^.^.^.^.^.^.....^.....^.^.......^.^.^.^.^.^.^...^.^.^.....^.^.^.^.^.......^.......^.^.^.^.^.^...^.^...^.^.^.^.^...^.^.........
.............................................................................................................................................
........^...^.^.^...^.^.....^...^.....^.^.^.....^.^...^...^...^.^.^.^.^...^.^.^.^...^.^.^...^...^.^...^.....^.^.^.^.........^.^...^.^........
.............................................................................................................................................
.......^.^...^.^.^.^.^.^.^...^.^.....^.^.^.^.^...^.^.^.^.^.^.^.^...^.^.^...^.^.^.^.^.^.....^.^.^.^...^.......^...^.^.^.^.......^...^.^.......
.............................................................................................................................................
......^.^.....^.....^.^.^.^...^.^.^.^...^.^...^.^...^.^.^.^.^.^.^.^...^.^.^...^.^...^.....^.^...^.....^.^.^.^...^.^.^.^.^.^...^...^.^.^......
.............................................................................................................................................
.....^.^.^.^...^...^.......^...^.^.^.^.^.^.^.^.^.^...^.^.^...^.^.^.^.^.^.^.^.^.^.^.^.^.^.......^.^.^.^.^.^.^.....^.^.^.^.....^.^.^.^.^.^.....
.............................................................................................................................................
....^.^.^...^.^.^.^.^.^...^.^.^.^.^.^.......^...^.^.^...^.^.^.^...^.^...^.^.......^.^.^.^.^.^.^.^.^.^.^.^.^.....^.^.^...^.^.^.....^.^...^....
.............................................................................................................................................
...^.^.^.^.^.^...^.^.^...^.^.^.^.^.^.^.^.^.^.^.......^.^.^.^...^.^.^.^.^.^...^.^...^.^.^.^.^.^.^.^.^.^...^.^.^.^.^.^...^.....^.....^.^.^.^...
.............................................................................................................................................
..^.^.^.^.^...........^...^.^...^.^.^.^.^...^...^.....^.^.^.....^.^.^.^...^.....^.....^.^.^...^.^.^.^.....^.^.^...^.^.^...^...^.^.^.^...^.^..
.............................................................................................................................................
.^...^.^.^.^.....^...^...^...^.....^.....^...^.^.^.....^.^.^.^.^...^.^.^.^.^...^.^...^.^.^.^...^.^...^.^...^.^.^.^.^.^.^.^.^.^.^...^...^.^.^.
.............................................................................................................................................
""".strip().split("\n")

print("Answer:", count_timelines(raw))
